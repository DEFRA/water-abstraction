{{> styles}}

<style type="text/css">
table thead th {
   width: 33%;
}
</style>

<main id="content" tabindex="-1">
  {{>element-phase-tag}}
  {{>element-main-nav}}

  <a class="link-back" href="/admin/abstraction-reform">Back</a>

  <div class="grid-row">
    <div class="column-full">

      <h1 class="heading-xlarge">
          <span class="heading-secondary">Review licence data</span>
          {{ licence.licence_data_value.LIC_NO }}
      </h1>

      <h2 class="heading-medium" id="licence">Licence Data</h2>

      {{#if canEdit }}
      <a href="/admin/abstraction-reform/licence/{{ documentId }}/edit/licence/{{ data.licence.base.ID }}#{{ @key }}">Edit licence data</a>
      {{/if}}

      <table>
        <thead>
          <tr>
            <th>NALD Field</th>
            <th>NALD data</th>
            <th>New Value</th>
          </tr>
        </thead>
        <tbody>
        {{#each data.licence.base }}
        <tr>
          <th>{{ @key }}</th>
          <td>{{ this }}</td>
          <td>
            {{#notEqual this (lookup ../data.licence.reform @key )}}
              {{lookup ../data.licence.reform @key }}
            {{/notEqual}}
          </td>
        </tr>
        {{/each}}
        </tbody>
      </table>

      <br />
      <br />
      <br />

      {{#each data.purposes as |purpose| }}

      <h2 id="purpose-{{ purpose.base.ID }}" class="heading-medium">Purpose</h2>

      {{#if canEdit }}
      <a href="/admin/abstraction-reform/licence/{{ ../documentId }}/edit/purpose/{{ purpose.base.ID }}">Edit this purpose</a>
      {{/if}}

      <table>
        <thead>
          <tr>
            <th>NALD Field</th>
            <th>NALD data</th>
            <th>New Value</th>
          </tr>
        </thead>
        <tbody>
        {{#each purpose.base }}
        <tr>
          <th>{{ @key }}</th>
          <td>{{ this }}</td>
          <td>{{#notEqual this (lookup purpose.reform @key )}}
            {{lookup purpose.reform @key }}
              {{/notEqual}}
          </td>
        </tr>
        {{/each}}
        </tbody>
      </table>

      <br />

      {{/each}}





      {{#each data.points as |point| }}

      <h2 id="point-{{ point.base.ID }}" class="heading-medium">Point</h2>

      {{#if canEdit }}
      <a href="/admin/abstraction-reform/licence/{{ ../documentId }}/edit/point/{{ point.base.ID }}">Edit this point</a>
      {{/if}}

      <table>
        <thead>
          <tr>
            <th>NALD Field</th>
            <th>NALD data</th>
            <th>New Value</th>
          </tr>
        </thead>
        <tbody>
        {{#each point.base }}
        <tr>
          <th>{{ @key }}</th>
          <td>{{ this }}</td>
          <td>{{#notEqual this (lookup point.reform @key )}}
            {{lookup point.reform @key }}
              {{/notEqual}}
          </td>
        </tr>
        {{/each}}
        </tbody>
      </table>

      <br />

      {{/each}}

      {{#each data.conditions as |condition| }}

      <h2 id="condition-{{ condition.base.ID }}" class="heading-medium">Condition</h2>


      {{#if canEdit }}
      <a href="/admin/abstraction-reform/licence/{{ ../documentId }}/edit/condition/{{ condition.base.ID }}">Edit this condition</a>
      {{/if}}

      <table>
        <thead>
          <tr>
            <th>NALD Field</th>
            <th>NALD data</th>
            <th>New Value</th>
          </tr>
        </thead>
        <tbody>
        {{#each condition.base }}
        <tr>
          <th>{{ @key }}</th>
          <td>{{ this }}</td>
          <td>{{#notEqual this (lookup condition.reform @key )}}
            {{lookup condition.reform @key }}
              {{/notEqual}}
          </td>
        </tr>
        {{/each}}
        </tbody>
      </table>

      <br />

      {{/each}}
    </div>
  </div>

  <div class="grid-row">
    <div class="column-full">
      <h2 class="heading-large">Workflow</h2>


      <!-- Submit for review -->
      <form method="POST" action="/admin/abstraction-reform/licence/{{ documentId }}/status">
        <input name="csrf_token" type="hidden" value="{{ csrfToken }}" />

        <div class="form-group">
          <label class="form-label" for="notes">
            Notes about these changes (optional)
          </label>
          <textarea class="form-control form-control-3-4" name="notes" id="notes" rows="5"></textarea>
        </div>

        <input name="status" value="In review" type="hidden" />

        <button type="submit" class="button">Submit for approval</button>

      </form>


    </div>
  </div>
</main>
