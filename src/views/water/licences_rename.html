{{> styles}}
<main id="content">
  {{>element-phase-tag}}
  <nav>
    <div class="breadcrumbs">
      {{>element-header-links}}
      <ol>
        <li><a href="/licences">Abstraction licences</a></li>
        <li><a href="/licences/{{ licence_id }}">Licence number: {{ licenceData.licenceNumber }}</a></li>
        <li><a href="/licences/{{ licence_id }}/rename">Name this licence</a></li>

      </ol>
    </div>
  </nav>
  <a class="link-back" href="/licences">Back</a>


  {{#if error}}
  <div class="error-summary" role="alert" aria-labelledby="error-summary-heading-example-2" tabindex="-1">

    <h1 class="heading-medium error-summary-heading" id="error-summary-heading-example-2">
      Licence not saved
    </h1>

    <ul class="error-summary-list">
        <li><a href="#name">There was a problem with the licence name field</a></li>
    </ul>

  </div>
  {{/if}}


  <h1 class="heading-large">Licence number: {{ licenceData.licenceNumber }}</h1>

  <p></p>

  <!-- Set licence name form -->
  <form novalidate class="form--well" name="nameForm" id="nameForm" method="POST" action="/licences/{{ licence_id }}">

    <div class="form-group {{#if error }}form-group-error{{/if}}">
      <label for="name" class="{{#if error }}form-label-error{{/if}}">

        <span class="form-label-bold">Licence name</span>
        <span class="sr-only">(maximum 32 characters)</span>
      {{#if error }}
        {{#each error.details }}
        <span class="error-message">
          {{#equal this.type 'string.min' }}The name must be at least 2 characters long{{/equal}}
          {{#equal this.type 'string.max' }}The name must be no more than 32 characters long{{/equal}}
          {{#equal this.type 'string.regex.base' }}The name can only use alphanumeric characters (A-Z and 0-9), spaces or apostrophes{{/equal}}
          {{#equal this.type 'any.required' }}The name field is required{{/equal}}
        </span>
        {{/each}}
      {{/if}}

      </label>

      <input minlength="2" maxlength="32" style="background: #fff" type="text" class="form-control {{#if error }}form-control-error{{/if}}" id="name" name="name" value="{{ name }}" />

    </div>

    <button type="submit" class="button">Save</button>
    <p class="form-cancel"><a href="/licences/{{ licence_id }}">Cancel</a></p>

  </form>



  <!-- Licence holder -->
  {{>element-licence-row label='Licence holder' answer=(concat licenceData.licenceHolderName '<br/><a href="/licences/' licence_id '/contact">View licence contact details</a>')}}

  <!-- Abstraction period -->
  {{#equal licenceData.abstractionPeriods.length 1 }}
  {{>element-licence-row label='Period of abstraction' answer=(formatPeriod licenceData.abstractionPeriods.0.periodStart licenceData.abstractionPeriods.0.periodEnd) }}
  {{/equal}}

  <!-- Points -->
  <div class="data-table">
    <div class="sourceofsupplyq">Point{{#greaterThan licenceData.points.length 1}}s{{/greaterThan}} of abstraction</div>
    <div class="licenceAnswer">

      {{#greaterThan licenceData.points.length 1}}
        <!-- Multiple purposes -->
        {{#lessThan licenceData.points.length 6 }}
        <ul class="sub-list">
          {{#each licenceData.points }}
          <li>{{ngrPoint this}}</li>
          {{/each}}
        </ul>
        {{else}}
        You have {{ licenceData.points.length }} abstraction points<br />
        {{/lessThan}}

        <a href="/licences/{{ licence_id }}/points">View details of your abstraction points</a>


      {{else}}
        {{ngrPoint licenceData.points }}<br />
        <a href="/licences/{{ licence_id }}/points">View details of your abstraction point</a>
      {{/greaterThan}}

    </div>
  </div>


  <!-- Purposes -->
  <div class="data-table">
    <div class="sourceofsupplyq">Purpose{{#greaterThan licenceData.purposes.length 1}}s{{/greaterThan}} of abstraction</div>
    <div class="licenceAnswer">

      {{#greaterThan licenceData.purposes.length 1}}
        <!-- Multiple purposes -->
        {{#lessThan licenceData.purposes.length 6 }}
        <ul class="list list-bullet">
          {{#each licenceData.purposes }}
          <li>{{this.name}}</li>
          {{/each}}
        </ul>
        {{else}}
        You have {{ licenceData.purposes.length }} abstraction purposes<br />
        {{/lessThan}}

        <a href="/licences/{{ licence_id }}/purposes">View details of your abstraction purposes</a>


      {{else}}
        {{licenceData.purposes.0.name }}<br />
        <a href="/licences/{{ licence_id }}/purposes">View details of your abstraction purpose</a>
      {{/greaterThan}}

    </div>
  </div>






  <!-- Abstraction conditions -->
  <div class="data-table">
    <div class="sourceofsupplyq">Abstraction condition{{#greaterThan licenceData.conditions.length 1}}s{{/greaterThan}}</div>
    <div class="licenceAnswer">

      {{#greaterThan licenceData.conditions.length 1}}
        <!-- Multiple purposes -->
        {{#lessThan licenceData.conditions.length 6 }}
        <ul class="sub-list">
          {{#each licenceData.conditions }}
          <li>{{this.displayTitle}}</li>
          {{/each}}
        </ul>
        {{else}}
        You have {{ licenceData.conditions.length }} abstraction conditions<br />
        {{/lessThan}}

        <a href="/licences/{{ licence_id }}/conditions">View details of your abstraction conditions</a>


      {{else}}
        {{licenceData.conditions.0.displayTitle }}<br />
        <a href="/licences/{{ licence_id }}/conditions">View details of your abstraction condition</a>
      {{/greaterThan}}

    </div>
  </div>



  {{#if licenceData.aggregateQuantity }}
  <div class="data-table">
      <div class="sourceofsupplyq">Maximum quantities before conditions</div>
      <div class="licenceAnswer">
        <ul class="sub-list">
        {{#each licenceData.aggregateQuantity }}
          <li>{{ precision this.value 2 }} {{ this.name }}</li>
        {{/each}}
        </ul>
      </div>
  </div>
  {{/if}}





  <p></p>
</main>
{{> footerjs}}


{{> debug}}
