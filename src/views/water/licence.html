{{> styles}}
<main id="content">
  {{>element-phase-tag}}
  <nav>
    <div class="breadcrumbs">
      <ol>
        <li><a href="/?access=PB01">Your service</a></li>
        <li><a href="/licences">Abstraction licences</a></li>
        <li><a href="/licences/{{ licence_id }}">Licence serial number: {{ licenceData.licence_ref }}</a></li>
        {{>element-header-links}}
      </ol>
    </div>
  </nav>
  <a class="link-back" href="/licences">Back</a>

  <h1 class="heading-medium">Licence serial number {{ licenceData.licence_ref }}</h1>

  <p></p>

  <!-- User-defined licence name row -->
  <div class="data-table">
    <label for="name" class="sourceofsupplyq">Licence name</label>
    <div class="licenceAnswer">

      <!-- Set licence name form -->
      <form name="nameForm" id="nameForm" class="hide-js" method="POST" action="/licences/{{ licence_id }}">
        <input type="text" class="form-control" id="name" name="name" value="{{ crmData.name}}" />
        <button type="submit" class="button button-inline">Save</button>
        <p class="show-js" style="margin-bottom: 0;"><a href="#" id="cancel">Cancel</a></p>
      </form>

      <!-- Current licence name -->
      <div id="licenceName" class="show-js">
      {{#if crmData.name }}
        {{ crmData.name}}
        <br />
        <a id="showForm" href="#nameForm">Change name</a>
      {{/if}}
      {{^crmData.name }}
        No licence name
        <br />
        <a href="#">Name this licence</a>
      {{/crmData.name}}
      </div>
    </div>
  </div>


  {{>element-licence-row label='Licence holder' answer=(concat licenceData.attributes.licenceData.name '<br/><a href="/licences/' licence_id '/contact">Licence contact details</a>')}}
  {{>element-licence-row label='Point of abstraction' answer=(ngrPoint licenceData.attributes.licenceData.purposes.0.points)}}
  {{>element-licence-row label='Licence effective from' answer=(formatDate licenceData.attributes.licenceData.effectiveFrom)}}
  {{>element-licence-row label='Licensed until' answer=(formatToDate licenceData.attributes.licenceData.effectiveTo)}}
  {{>element-licence-row label='Source of supply' answer=licenceData.attributes.licenceData.sourceOfSupply}}
  {{>element-licence-row label='Period of abstraction' answer=(formatPeriod licenceData.attributes.licenceData.purposes.0.periodStart licenceData.attributes.licenceData.purposes.0.periodEnd)}}
  {{>element-licence-row label='Maximum quantities before conditions' answer=(maxQuantities licenceData.attributes.licenceData)}}
  <div class="greyline" style="border-bottom: 1px solid #bfc1c3;"></div>
  <p></p>
  <p><a href="/licences/{{licence_id}}/terms">Read your full licence terms of use</a></p>
  <p></p>
</main>
{{> footerjs}}

<script src="/public/javascripts/licence-name-form.js"></script>

{{> debug}}
