{{> styles}}
<main id="content">
  {{>element-phase-tag}}
  <nav>
    <div class="breadcrumbs">
      {{>element-header-links}}
      <ol>
        <li><a href="/licences">Abstraction licences</a></li>
        <li><a href="/licences/{{ licence_id }}">Licence number: {{ licenceData.licenceNumber }}</a></li>
      </ol>
    </div>
  </nav>
  <a class="link-back" href="/licences">Back</a>


  {{#if crmData.document_custom_name }}
  <h1 class="heading-large">Licence name: {{ crmData.document_custom_name }}</h1>
  {{else}}
  <h1 class="heading-large">Licence number: {{ licenceData.licenceNumber }}</h1>
  {{/if}}


  <p>Starts {{ formatDate licenceData.effectiveDate }}
     {{#if licenceData.expiryDate }}
      and expires {{ formatToDate licenceData.expiryDate }}
     {{else}}
      and has no expiry
     {{/if}}
   </p>

  <!-- User-defined licence name row -->
  <div class="data-row">
    <div class="data-row__param">Licence name</div>
    <div class="data-row__value">


      <!-- Current licence name -->
      {{#if crmData.document_custom_name }}
        {{ crmData.document_custom_name}}
        <br />
        <a id="showForm" href="/licences/{{ licence_id }}/rename">Change name</a>
      {{/if}}
      {{^crmData.document_custom_name }}
        No licence name
        <br />
        <a id="nameLicence" href="/licences/{{ licence_id }}/rename">Name this licence</a>
      {{/crmData.document_custom_name}}

    </div>
  </div>



  {{>element-licence-row label='Licence holder' answer=(concat licenceData.licenceHolderTitle ' ' licenceData.licenceHolderInitials ' ' licenceData.licenceHolderName '<br/><a href="/licences/' licence_id '/contact">View licence contact details</a>')}}

  {{#greaterThan licenceData.abstractionPeriods.length 0}}
  <!-- Periods -->
  <div class="data-row">
    <div class="data-row__param">Period{{#greaterThan licenceData.abstractionPeriods.length 1}}s{{/greaterThan}} of abstraction</div>
    <div class="data-row__value">

      {{#greaterThan licenceData.abstractionPeriods.length 1}}
        <!-- Multiple purposes -->
        {{#lessThan licenceData.abstractionPeriods.length 6 }}
        <ul class="sub-list">
          {{#each licenceData.abstractionPeriods }}
          <li>{{formatPeriod periodStart periodEnd }}</li>
          {{/each}}
        </ul>
        {{else}}
        You have {{ licenceData.abstractionPeriods.length }} abstraction periods<br />
        {{/lessThan}}

        <a href="/licences/{{ licence_id }}/purposes">View details of your abstraction periods</a>


      {{else}}
        {{formatPeriod licenceData.abstractionPeriods.0.periodStart licenceData.abstractionPeriods.0.periodEnd  }}<br />
        <a href="/licences/{{ licence_id }}/purposes">View details of your abstraction period</a>
      {{/greaterThan}}


    </div>
  </div>
  {{/greaterThan}}


  <!-- Points -->
  <div class="data-row">
    <div class="data-row__param">Point{{#greaterThan licenceData.points.length 1}}s{{/greaterThan}} of abstraction</div>
    <div class="data-row__value">

      {{#greaterThan licenceData.points.length 1}}
        <!-- Multiple purposes -->
        {{#lessThan licenceData.points.length 6 }}
        <ul class="sub-list">
          {{#each licenceData.points }}
          <li>{{ngrPoint this}}</li>
          {{/each}}
        </ul>
        {{else}}
        You have {{ licenceData.points.length }} abstraction points<br />
        {{/lessThan}}

        <a href="/licences/{{ licence_id }}/points">View details of your abstraction points</a>


      {{else}}
        {{ngrPoint licenceData.points }}<br />
        <a href="/licences/{{ licence_id }}/points">View details of your abstraction point</a>
      {{/greaterThan}}

    </div>
  </div>


  <!-- Purposes -->
  <div class="data-row">
    <div class="data-row__param">Purpose{{#greaterThan licenceData.uniquePurposeNames.length 1}}s{{/greaterThan}} of abstraction</div>
    <div class="data-row__value">

      {{#greaterThan licenceData.uniquePurposeNames.length 1}}
        <!-- Multiple purposes -->
        {{#lessThan licenceData.uniquePurposeNames.length 6 }}
        <ul class="sub-list">
          {{#each licenceData.uniquePurposeNames }}
          <li>{{this}}</li>
          {{/each}}
        </ul>
        {{else}}
        You have {{ licenceData.uniquePurposeNames.length }} abstraction purposes<br />
        {{/lessThan}}

        <a href="/licences/{{ licence_id }}/purposes">View details of your abstraction purposes</a>


      {{else}}
        {{licenceData.uniquePurposeNames }}<br />
        <a href="/licences/{{ licence_id }}/purposes">View details of your abstraction purpose</a>
      {{/greaterThan}}

    </div>
  </div>

  <!-- Abstraction conditions -->
  <div class="data-row">
    <div class="data-row__param">Abstraction condition{{#greaterThan licenceData.conditions.length 1}}s{{/greaterThan}}{{#equal licenceData.conditions.length 0}}s{{/equal}}</div>
    <div class="data-row__value">

      {{#greaterThan licenceData.conditions.length 1}}
        <!-- Multiple purposes -->
        {{#lessThan licenceData.conditions.length 6 }}
        <ul class="sub-list">
          {{#each licenceData.conditions }}
          <li>{{this.displayTitle}}</li>
          {{/each}}
        </ul>
        {{else}}
        You have {{ licenceData.conditions.length }} abstraction conditions<br />
        {{/lessThan}}

        <a href="/licences/{{ licence_id }}/conditions">View details of your abstraction conditions</a>


      {{else}}
        {{#greaterThan licenceData.conditions.length 0}}
          {{licenceData.conditions.0.displayTitle }}<br />
          <a href="/licences/{{ licence_id }}/conditions">View details of your abstraction condition</a>
        {{else}}
          <a href="/licences/{{ licence_id }}/conditions">View details of your abstraction conditions</a>
        {{/greaterThan}}

      {{/greaterThan}}

    </div>
  </div>



  {{#if licenceData.aggregateQuantity }}
  <div class="data-row">
      <div class="data-row__param">Maximum quantities before conditions</div>
      <div class="data-row__value">
        <ul class="sub-list">
        {{#each licenceData.aggregateQuantity }}
          <li>{{ precision this.value 2 }} {{ this.name }}</li>
        {{/each}}
        </ul>
      </div>
  </div>
  {{/if}}




  <p></p>
  <p></p>
</main>
{{> footerjs}}

{{> debug}}
