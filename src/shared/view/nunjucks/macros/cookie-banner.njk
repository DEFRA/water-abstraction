{% from "govuk/components/cookie-banner/macro.njk" import govukCookieBanner %}

{% macro cookieBannerJS() %}
  {% set html %}
    <p>We use some essential cookies to make this service work.</p>
    <p>We’d also like to use analytics cookies so we can understand how you use the service and make improvements.</p>
  {% endset %}

  {% set acceptedHtml %}
    <p>You’ve accepted analytics cookies. You can <a class="govuk-link" href="/cookies">change your cookie settings</a> at any time.</p>
  {% endset %}

  {% set rejectedHtml %}
    <p>You’ve rejected analytics cookies. You can <a class="govuk-link" href="/cookies">change your cookie settings</a> at any time.</p>
  {% endset %}

  {{ govukCookieBanner({
    ariaLabel: "Cookies on Manage your water abstraction or impoundment licence",
    attributes: {
      id: 'cookie-banner-js-enabled'
    },
    messages: [
      {
        headingText: "Cookies on Manage your water abstraction or impoundment licence",
        html: html,
        attributes: {
          'data-cookie-bar' : 'choices'
        },
        actions: [
          {
            text: "Accept analytics cookies",
            type: "button",
            name: "cookies",
            value: "accept"
          },
          {
            text: "Reject analytics cookies",
            type: "button",
            name: "cookies",
            value: "reject"
          },
          {
            text: "View cookies",
            href: "/cookies"
          }
        ]
      },
      {
      html: acceptedHtml,
      role: "alert",
      attributes: {
        'data-cookie-bar' : 'accepted'
      },
      hidden: true,
      actions: [
        {
          text: "Hide this message",
          value: "hide"
        }
      ]
    },
    {
      html: rejectedHtml,
      role: "alert",
      attributes: {
        'data-cookie-bar' : 'rejected'
      },
      hidden: true,
      actions: [
        {
          text: "Hide this message",
          value: "hide"
        }
      ]
    }
    ]
  }) }}

{% endmacro %}


{% macro cookieBannerNoJS() %}
    {{ govukCookieBanner({
      attributes: {
        id: 'cookie-banner-js-disabled'
      },
      ariaLabel: "Cookies on Manage your water abstraction or impoundment licence",
      messages: [
        {
          headingText: "Cookies on Manage your water abstraction or impoundment licence",
          text: "We use some essential cookies to make this service work.",
          actions: [
            {
              text: "View cookies",
              href: "/cookies"
            }
          ]
        }
      ]
    }) }}
{% endmacro %}

{% macro cookieBanner(isVisible) %}
  {% if isVisible %}
    {{ cookieBannerJS() }}
    {{ cookieBannerNoJS() }}
  {% endif %}
{% endmacro %}
